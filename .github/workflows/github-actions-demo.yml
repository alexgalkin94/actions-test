name: Fun API Workflow Trigger

on:
  workflow_dispatch:

jobs:
  test-api:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'

      - name: Install dependencies
        run: npm install axios

      - name: Trigger API and validate response
        env:
          API_URL: ${{ secrets.API_URL }}
        run: |
          node -e "
const axios = require('axios');
const apiUrl = process.env.API_URL;

axios.get(apiUrl)
  .then(response => {
    if (response.status === 200) {
      console.log('ðŸŽ‰ Success! API responded with status code 200');
      console.log('Response:', response.data);
    } else {
      console.log('ðŸ’¥ Oops! API responded with status code', response.status);
      throw new Error('API response not 200');
    }
  })
  .catch(error => {
    console.error('ðŸ’¥ Oops! An error occurred:', error.message);
    process.exit(1);
  });
"
